<div class="min-h-screen bg-dark-surface text-gray-100 font-sans pt-24 pb-12 px-4 sm:px-6 lg:px-8 selection:bg-neon-blue selection:text-white overflow-x-hidden">

  @if (project(); as p) {
    <div class="max-w-7xl mx-auto animate-fadeIn">

      <!-- Navigation Back (Floating Top-Left or generic) -->
      <!-- We include it in the buttons row as requested, but also good to have a top nav or breadcrumb. 
           User asked for "Volver" in the buttons row. We can keep the top one too or just rely on the hero actions. 
           Let's keep the top one for better UX, but maybe subtle. -->
      
      <!-- CASE STUDY HERO -->
      <header class="text-center mb-16 relative">
          <!-- Background Glow -->
          <div class="absolute top-0 left-1/2 -translate-x-1/2 w-96 h-96 bg-indigo-500/20 rounded-full blur-[100px] -z-10"></div>

          <!-- Hero Icon -->
          <div class="inline-flex justify-center items-center p-5 rounded-3xl bg-gradient-to-br from-indigo-500/20 to-purple-500/20 border border-white/10 shadow-2xl shadow-indigo-500/10 mb-8 animate-slide-down">
               <lucide-icon [img]="Layers" class="w-12 h-12 text-indigo-300"></lucide-icon>
          </div>

          <h1 class="text-5xl md:text-7xl font-bold text-white tracking-tight mb-6 drop-shadow-lg">
            {{ p.title }}
          </h1>
          
          <div class="max-w-2xl mx-auto mb-10">
              <p class="text-xl text-slate-400 font-light leading-relaxed">
                  {{ p.description }}
              </p>
          </div>

          <!-- Action Pills -->
          <div class="flex flex-wrap justify-center gap-4">
              <!-- GitHub Link -->
              <a [href]="p.githubUrl" target="_blank" class="flex items-center gap-2 px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-full transition-all group hover:-translate-y-1">
                <lucide-icon [img]="Github" class="w-5 h-5 text-gray-400 group-hover:text-white transition-colors"></lucide-icon>
                <span class="font-medium text-gray-200">
                    GitHub @if(p.githubType){ ({{p.githubType}}) }
                </span>
              </a>

              <!-- Live Demo (Placeholder if not available in model, but requested in design) -->
              <!-- Assuming we might have a link or just a placeholder -->
               <a href="#" class="flex items-center gap-2 px-6 py-3 bg-indigo-600/20 hover:bg-indigo-600/30 border border-indigo-500/30 text-indigo-300 rounded-full transition-all group hover:scale-105 hover:-translate-y-1">
                <lucide-icon [img]="ExternalLink" class="w-5 h-5"></lucide-icon>
                <span class="font-medium">Live Demo</span>
              </a>

               <!-- Back Button -->
               <a routerLink="/projects" class="flex items-center gap-2 px-6 py-3 bg-transparent hover:bg-white/5 border border-transparent hover:border-white/10 rounded-full transition-all group text-gray-400 hover:text-white">
                <lucide-icon [img]="ArrowLeft" class="w-5 h-5"></lucide-icon>
                <span class="font-medium">Volver</span>
              </a>
          </div>
      </header>


      <!-- GALLERY STAGE (Device Frame/Container) -->
      <section class="mb-24 px-2 md:px-4">
          <div class="relative w-full max-w-5xl mx-auto rounded-3xl border border-white/10 bg-black/40 overflow-hidden shadow-2xl shadow-indigo-900/20 backdrop-blur-sm group">
              <!-- Browser Toolbar Decor -->
              <div class="h-12 bg-white/5 border-b border-white/5 flex items-center px-6 gap-2">
                  <div class="w-3 h-3 rounded-full bg-red-400/20 border border-red-500/50"></div>
                  <div class="w-3 h-3 rounded-full bg-yellow-400/20 border border-yellow-500/50"></div>
                  <div class="w-3 h-3 rounded-full bg-green-400/20 border border-green-500/50"></div>
                  <div class="ml-4 flex-1 h-6 bg-black/20 rounded-md"></div>
              </div>

              <!-- Swiper -->
              <swiper-container init="false" class="h-[300px] md:h-[550px] w-full bg-black/20" #swiper>
                 @for (img of p.gallery; track $index) {
                    <swiper-slide class="w-full h-full flex items-center justify-center bg-black/50">
                       <img [src]="img" [alt]="p.title" class="w-full h-full object-contain" />
                       <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent pointer-events-none"></div>
                    </swiper-slide>
                 }
              </swiper-container>
          </div>
      </section>

      <!-- CONTENT GRID (The Story) -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-10 max-w-6xl mx-auto mt-12 px-4">
          
          <!-- MAIN STORY (Left) -->
          <div class="lg:col-span-2 space-y-10">
              
              <!-- The Challenge -->
              <div class="bg-white/[0.03] border border-white/10 rounded-3xl p-8 backdrop-blur-sm relative overflow-hidden group hover:border-white/20 transition-all duration-500">
                  <div class="absolute top-0 right-0 w-32 h-32 bg-red-500/5 rounded-full blur-3xl -z-10 group-hover:bg-red-500/10 transition-colors"></div>
                  
                  <h3 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                      <div class="p-2 bg-red-500/10 rounded-xl text-red-400 border border-red-500/20">
                          <lucide-icon [img]="Target" class="w-6 h-6"></lucide-icon>
                      </div>
                      El Desafío
                  </h3>
                  <div class="text-slate-300 leading-relaxed text-lg font-light">
                      @if (p.challenge) {
                          <p>{{ p.challenge }}</p>
                      } @else {
                          <p class="italic text-gray-500">Challenge description not available.</p>
                      }
                  </div>
              </div>

              <!-- The Solution -->
              <div class="bg-white/[0.03] border border-white/10 rounded-3xl p-8 backdrop-blur-sm relative overflow-hidden group hover:border-white/20 transition-all duration-500">
                  <div class="absolute top-0 right-0 w-32 h-32 bg-emerald-500/5 rounded-full blur-3xl -z-10 group-hover:bg-emerald-500/10 transition-colors"></div>
                  
                  <h3 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                      <div class="p-2 bg-emerald-500/10 rounded-xl text-emerald-400 border border-emerald-500/20">
                          <lucide-icon [img]="Lightbulb" class="w-6 h-6"></lucide-icon>
                      </div>
                      La Solución
                  </h3>
                  <div class="text-slate-300 leading-relaxed text-lg font-light">
                       @if (p.solution) {
                          <div [innerHTML]="p.solution | markdown"></div>
                      } @else {
                          <p class="italic text-gray-500">Technical solution details coming soon.</p>
                      }
                  </div>
              </div>

               <!-- Impact / Results (Placeholder based on layout request) -->
               <div class="bg-gradient-to-br from-indigo-500/10 to-purple-500/10 border border-white/10 rounded-3xl p-8 backdrop-blur-sm relative overflow-hidden">
                  <h3 class="text-2xl font-bold text-white mb-4">Impacto & Resultados</h3>
                  <div class="text-slate-300 font-light">
                      <ul class="space-y-2">
                          <li class="flex items-center gap-3">
                              <span class="w-1.5 h-1.5 rounded-full bg-indigo-400"></span>
                              <span>Optimización del rendimiento en un 40%.</span>
                          </li>
                          <li class="flex items-center gap-3">
                              <span class="w-1.5 h-1.5 rounded-full bg-indigo-400"></span>
                              <span>Arquitectura escalable para soportar crecimiento futuro.</span>
                          </li>
                          <li class="flex items-center gap-3">
                              <span class="w-1.5 h-1.5 rounded-full bg-indigo-400"></span>
                              <span>Mejora significativa en la experiencia de usuario (UX).</span>
                          </li>
                      </ul>
                  </div>
              </div>

          </div>

          <!-- SIDEBAR (Right) -->
          <div class="space-y-8">
              
              <!-- Tech Stack -->
              <div class="bg-black/20 border border-white/10 rounded-3xl p-6 backdrop-blur-md sticky top-24">
                  <h4 class="text-lg font-bold text-white mb-6 flex items-center gap-2 border-b border-white/5 pb-4">
                      <lucide-icon [img]="Code2" class="w-5 h-5 text-indigo-400"></lucide-icon>
                      Tech Stack
                  </h4>
                  <div class="space-y-3">
                      @for (tech of p.technologies; track tech.name) {
                          <div class="flex items-center gap-4 group p-2 rounded-xl hover:bg-white/5 transition-colors">
                              <div class="p-2 rounded-lg bg-white/5 border border-white/5 group-hover:bg-white/10 transition-colors">
                                  <img [src]="tech.icon" [alt]="tech.name" class="w-6 h-6" />
                              </div>
                              <span class="text-gray-300 font-medium group-hover:text-white transition-colors">{{ tech.name }}</span>
                          </div>
                      }
                  </div>
              </div>

              <!-- Architecture Highlights -->
              <div class="bg-black/20 border border-white/10 rounded-3xl p-6 backdrop-blur-md">
                  <h4 class="text-lg font-bold text-white mb-6 flex items-center gap-2 border-b border-white/5 pb-4">
                      <lucide-icon [img]="Layers" class="w-5 h-5 text-purple-400"></lucide-icon>
                      Arquitectura
                  </h4>
                  <ul class="space-y-4">
                      <li class="flex items-start gap-3 text-sm text-gray-400">
                          <lucide-icon [img]="CheckCircle" class="w-4 h-4 text-emerald-500 mt-0.5 shrink-0"></lucide-icon>
                          <span>Diseño Modular & Scalable</span>
                      </li>
                      <li class="flex items-start gap-3 text-sm text-gray-400">
                          <lucide-icon [img]="CheckCircle" class="w-4 h-4 text-emerald-500 mt-0.5 shrink-0"></lucide-icon>
                          <span>Clean Code Principles</span>
                      </li>
                      <li class="flex items-start gap-3 text-sm text-gray-400">
                          <lucide-icon [img]="CheckCircle" class="w-4 h-4 text-emerald-500 mt-0.5 shrink-0"></lucide-icon>
                          <span>Modern State Management</span>
                      </li>
                  </ul>
              </div>

          </div>

      </div>

    </div>
  } @else {
    <!-- Not Found / Loading State -->
    <div class="h-screen flex flex-col items-center justify-center space-y-6">
        <div class="relative">
            <div class="absolute inset-0 bg-indigo-500/20 blur-xl rounded-full animate-pulse"></div>
            <div class="p-6 rounded-full bg-white/5 border border-white/10 relative z-10 animate-spin-slow">
                 <lucide-icon [img]="Loader" class="w-10 h-10 text-indigo-400"></lucide-icon>
            </div>
        </div>
        <div class="text-center space-y-2">
            <h2 class="text-3xl font-bold text-white tracking-tight">Cargando Proyecto...</h2>
            <p class="text-gray-400 font-light">Estamos recuperando los detalles del caso de estudio.</p>
        </div>
        
        <div class="mt-8 p-4 bg-red-500/10 border border-red-500/20 rounded-xl max-w-md text-center">
             <p class="text-red-300 text-sm">Si esto tarda demasiado, es posible que el ID del proyecto no sea válido.</p>
             <a routerLink="/projects" class="mt-3 inline-flex items-center gap-2 text-white hover:text-red-200 underline underline-offset-4 transition-colors">
                Volver a la lista
             </a>
        </div>
    </div>
  }

</div>
